

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <title>Better configuration change workflow with Git-to-CD mirroring &mdash; Central Dogma 0.77.2 documentation</title>
  

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="_static/overrides.css" type="text/css" />

  
  

  
  

  

  
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Authentication and Access Control" href="auth.html" />
    <link rel="prev" title="Java client library" href="client-java.html" />
  <script src="https://cdn.jsdelivr.net/npm/interactjs@1.4.0/dist/interact.min.js"></script>
  <script src="_static/center_page.js"></script>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.6/styles/default.min.css">
   

</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="index.html">
          

          
            
            <img src="_static/central_dogma.png" class="logo" alt="Logo"/>
          
          </a>

          
            
            
              <div class="version">
                0.77
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="setup.html">Setting up</a></li>
<li class="toctree-l1"><a class="reference internal" href="concepts.html">Concepts</a></li>
<li class="toctree-l1"><a class="reference internal" href="client-cli.html">Command-line client</a></li>
<li class="toctree-l1"><a class="reference internal" href="client-java.html">Java client library</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Better configuration change workflow with Git-to-CD mirroring</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#setting-up-a-mirror">Setting up a mirror</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#setting-up-a-mirroring-task">Setting up a mirroring task</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#mirror-limit-settings">Mirror limit settings</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="auth.html">Authentication and Access Control</a></li>
<li class="toctree-l1"><a class="reference internal" href="known-issues.html">Known issues</a></li>
<li class="toctree-l1"><a class="reference external" href="https://github.com/line/centraldogma/releases">Release notes</a></li>
<li class="toctree-l1"><a class="reference external" href="apidocs/index.html#://">API documentation</a></li>
<li class="toctree-l1"><a class="reference external" href="xref/index.html#://">Source cross-reference</a></li>
<li class="toctree-l1"><a class="reference external" href="https://github.com/line/centraldogma/issues?q=label%3Aquestion-answered">Questions and answers</a></li>
<li class="toctree-l1"><a class="reference external" href="https://github.com/line/centraldogma">Fork me on GitHub</a></li>
<li class="toctree-l1"><a class="reference external" href="https://github.com/line/centraldogma/blob/main/CONTRIBUTING.md">Contributing</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">Central Dogma</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html" class="icon icon-home"></a> &raquo;</li>
        
      <li>Better configuration change workflow with Git-to-CD mirroring</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
          
            
              <a href="https://github.com/line/centraldogma/blob/main/site/src/sphinx/mirroring.rst" class="fa fa-github"> Edit on GitHub</a>
            
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="better-configuration-change-workflow-with-git-to-cd-mirroring">
<span id="mirroring"></span><h1>Better configuration change workflow with Git-to-CD mirroring<a class="headerlink" href="#better-configuration-change-workflow-with-git-to-cd-mirroring" title="Permalink to this headline">¶</a></h1>
<p>Making a configuration change is often a risky business. Pushing an invalid configuration change can cause your
service to malfunction even if zero line of code is changed. To reduce the chance of outage due to incorrect
configuration changes, you would want them reviewed by many eyes before they are applied.</p>
<p>Modern source code hosting services such as <a class="reference external" href="https://github.com/">GitHub</a> and <a class="reference external" href="https://about.gitlab.com/">GitLab</a>
have a notion of <a class="reference external" href="https://help.github.com/articles/about-pull-requests/">pull request</a>. What if we use pull
requests for configuration changes just like we do for source code, given the importance of service
configuration?</p>
<p>With Central Dogma’s periodic Git repository mirroring, you can set up the following workflow in your
organization:</p>
<ul class="simple">
<li><p>Humans work on a Git repository to manage the configuration files.</p>
<ol class="arabic simple">
<li><p>Store the configuration files in a Git repository.</p></li>
<li><p>Send a pull request that updates the configuration files.</p></li>
<li><p>The pull request is reviewed and merged.</p></li>
</ol>
</li>
<li><p>Applications work on a Central Dogma repository to retrieve the configuration files.</p>
<ol class="arabic simple">
<li><p>Central Dogma mirrors the configuration files in the Git repository into a Central Dogma repository.</p></li>
<li><p>Applications watches the configuration files in the Central Dogma repository.</p></li>
</ol>
</li>
</ul>
<p>Note that the applications do not access Git repositories directly. There are a few good reasons to make your
applications access Central Dogma repositories instead:</p>
<ul class="simple">
<li><p>Source code repositories are often hosted in a different network.</p></li>
<li><p>Source code repositories are not always highly-available, although they may be backed up regularly.</p></li>
<li><p>Central Dogma repositories are highly-available, queryable and watchable.</p></li>
</ul>
<div class="section" id="setting-up-a-mirror">
<h2>Setting up a mirror<a class="headerlink" href="#setting-up-a-mirror" title="Permalink to this headline">¶</a></h2>
<p>First, you need to create a credential to access the Git repository. You can create a project-wide credential
via project settings or a repository-specific credential via repository settings.</p>
<p>Currently, you can use SSH key authentication, password-based authentication, or access token-based authentication.</p>
<div class="section" id="setting-up-a-mirroring-task">
<h3>Setting up a mirroring task<a class="headerlink" href="#setting-up-a-mirroring-task" title="Permalink to this headline">¶</a></h3>
<p>You can set up a mirroring task via repository settings.</p>
<img alt="_images/mirroring_1.png" src="_images/mirroring_1.png" />
<p>Here is the properties of the mirroring task:</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">Mirror</span> <span class="pre">ID</span></code></p>
<ul class="simple">
<li><p>the ID of the mirroring task. This must be unique in the repository.</p></li>
</ul>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">Schedule</span></code></p>
<ul class="simple">
<li><p>a <a class="reference external" href="https://www.quartz-scheduler.org/documentation/quartz-2.3.0/tutorials/crontrigger.html">Quartz cron expression</a>
that describes when the mirroring task is supposed to be triggered. If unspecified, <code class="docutils literal notranslate"><span class="pre">0</span> <span class="pre">*</span> <span class="pre">*</span> <span class="pre">*</span> <span class="pre">*</span> <span class="pre">?</span></code>
(every minute) is used.</p></li>
</ul>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">Direction</span></code></p>
<ul class="simple">
<li><p>the direction of mirror.</p></li>
</ul>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">Local</span> <span class="pre">path</span></code></p>
<ul class="simple">
<li><p>the directory path. The content of the <code class="docutils literal notranslate"><span class="pre">remote</span> <span class="pre">path</span></code> will be mirrored into this directory.
If unspecified, <code class="docutils literal notranslate"><span class="pre">/</span></code> is used.</p></li>
</ul>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">Remote</span></code></p>
<ul class="simple">
<li><p>Supported schemes are:</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">git+http</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">git+https</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">git+ssh</span></code></p></li>
</ul>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">repo</span></code></p>
<ul>
<li><p>the uri of the remote Git repository except the scheme.
e.g. <code class="docutils literal notranslate"><span class="pre">github.com/foo.git</span></code></p></li>
</ul>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">branch</span></code></p>
<ul>
<li><p>the branch name of the remote Git repository. If unspecified, the default branch of the remote
Git repository is used.</p></li>
</ul>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">path</span></code></p>
<ul>
<li><p>the path of the remote Git repository. If unspecified, the whole content of
the remote Git repository is mirrored.</p></li>
</ul>
</li>
</ul>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">Credential</span></code></p>
<ul class="simple">
<li><p>the ID of the credential to use for authentication.</p></li>
</ul>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">gitignore</span></code></p>
<ul class="simple">
<li><p>a <cite>gitignore &lt;https://git-scm.com/docs/gitignore&gt;</cite> specifies files that should be excluded from mirroring.
The type of gitignore can either be a string containing the entire file (e.g. <code class="docutils literal notranslate"><span class="pre">/filename.txt\ndirectory</span></code>) or an array
of strings where each line represents a single pattern.</p></li>
</ul>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">Zone</span></code> (Displayed only if <code class="docutils literal notranslate"><span class="pre">zone</span></code> in the <a class="reference internal" href="setup-configuration.html#setup-configuration"><span class="std std-ref">Configuration</span></a> is configured)</p>
<blockquote>
<div><ul class="simple">
<li><p>the zone where the mirroring task is executed.</p></li>
<li><p>If unspecified:</p>
<ul>
<li><p>a mirroring task is executed in the first zone of <code class="docutils literal notranslate"><span class="pre">zone.allZones</span></code> configuration.</p></li>
<li><p>if <code class="docutils literal notranslate"><span class="pre">zone.allZones</span></code> is not configured, a mirroring task is executed in the leader replica.</p></li>
</ul>
</li>
</ul>
</div></blockquote>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">Enable</span> <span class="pre">mirror</span></code></p>
<ul class="simple">
<li><p>whether the mirroring task is enabled.</p></li>
</ul>
</li>
</ul>
</div>
</div>
<div class="section" id="mirror-limit-settings">
<h2>Mirror limit settings<a class="headerlink" href="#mirror-limit-settings" title="Permalink to this headline">¶</a></h2>
<p>Central Dogma limits the number of files and the total size of the files in a mirror for its reliability.
As your configuration grows, you may want to bump the limit. See <a class="reference internal" href="setup-configuration.html#setup-configuration"><span class="std std-ref">Configuration</span></a> to learn about
the options related with mirroring: <code class="docutils literal notranslate"><span class="pre">numMirroringThreads</span></code>, <code class="docutils literal notranslate"><span class="pre">maxNumFilesPerMirror</span></code> and
<code class="docutils literal notranslate"><span class="pre">maxNumBytesPerMirror</span></code>.</p>
</div>
</div>


           </div>
           
          </div>
          <footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
        <a href="auth.html" class="btn btn-neutral float-right" title="Authentication and Access Control" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
        <a href="client-java.html" class="btn btn-neutral float-left" title="Java client library" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>
        &#169; Copyright 2017-2025, LINE Corporation.

    </p>
  </div>
    
    
    
    Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>
        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
  
  <a href="https://github.com/line/centraldogma" class="github-corner" aria-label="View source on GitHub">
    <svg width="80" height="80" viewBox="0 0 250 250" aria-hidden="true">
      <path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z" fill="#1e2834"></path>
      <path class="octo-arm" d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2" fill="#ffffff" style="transform-origin: 130px 106px;"></path>
      <path class="octo-body" d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z" fill="#ffffff"></path>
    </svg>
  </a>
  <script type="text/javascript" src="_static/add_badges.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.6/highlight.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.6/languages/gradle.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.6/languages/protobuf.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.6/languages/thrift.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.6/languages/yaml.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/highlightjs-line-numbers.js/2.7.0/highlightjs-line-numbers.min.js"></script>
  <script>
    document.querySelectorAll('div.hljs > pre').forEach(function(block) {
      hljs.highlightBlock(block);
      hljs.lineNumbersBlock(block);
    });
  </script>
   


</body>
</html>